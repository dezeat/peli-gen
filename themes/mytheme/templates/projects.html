{% extends "base.html" %}

{% block content %}
<section class="container projects-page-section">

    {# 1. Create a clean list of just projects #}
    {% set projects = articles | selectattr('metadata.type', 'equalto', 'project') | list %}

    {# 2. The Hero Card (Uses the first item: projects[0]) #}
    {% if projects %}
        {% set hero = projects[0] %}
        <div class="projects-featured-hero">
            <a href="{{ SITEURL }}{{ hero.url }}" class="project-hero-card">
                <div class="hero-card-media">
                    {% if hero.metadata.get('image') %}
                    {# Added SITEURL to ensure image path is correct #}
                    <img src="{{ SITEURL }}/{{ hero.metadata.get('image') }}" alt="{{ hero.title }} hero image">
                    {% endif %}
                </div>
                <div class="hero-card-content">
                    <span class="tag">Featured Project</span>
                    <h2>{{ hero.title }}</h2>
                    <p>{{ hero.summary|striptags|truncate(200) }}</p>
                    <span class="btn">View Project Details →</span>
                </div>
            </a>
        </div>
    {% endif %}

    {# 3. The Grid (Loops through the REST: projects[1:]) #}
    <div class="projects-grid">
        {% for project in projects[1:] %}
            <a href="{{ SITEURL }}{{ project.url }}" class="project-card">
                
                {% if project.metadata.get('image') %}
                <div class="project-media">
                    {# Added SITEURL here as well #}
                    <img src="{{ SITEURL }}/{{ project.metadata.get('image') }}" alt="{{ project.title }}">
                </div>
                {% else %}
                <div class="project-placeholder">No Image</div>
                {% endif %}
                
                <div class="project-content">
                    <h3>{{ project.title }}</h3>
                    <p>{{ project.summary }}</p>
                    <span class="read-more">View Project →</span>
                </div>
            </a>
        {% endfor %}
    </div>
</section>
{% endblock %}