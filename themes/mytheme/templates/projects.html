{% extends "base.html" %}

{% block content %}
<section class="container projects-page-section">

    {# 1. Create a clean list of just projects #}
    {% set projects = articles | selectattr('metadata.type', 'equalto', 'project') | list %}

    {# 2. The Hero Card #}
    {% if projects %}
        {% set hero = projects[0] %}
        <div class="projects-featured-hero">
            <a href="{{ SITEURL }}{{ hero.url }}" class="project-hero-card">
                <div class="hero-card-media">
                    {% if hero.metadata.get('thumbnail') %}
                    <img src="{{ SITEURL }}/{{ hero.metadata.get('thumbnail') }}" alt="{{ hero.title }} hero image">
                    {% endif %}
                </div>
                <div class="hero-card-content">
                    <span class="tag">Featured Project</span>
                    <h2>{{ hero.title }}</h2>
                    <p>{{ hero.summary|striptags|truncate(200) }}</p>
                    <span class="btn">View Project Details â†’</span>
                </div>
            </a>
        </div>
    {% endif %}

    {# 3. The Grid #}
    <div class="projects-grid">
        {% for project in projects[1:] %}
            <article class="card" style="width: 100%; max-width: none; margin: 0; display: flex; flex-direction: column;">
                
                {% if project.metadata.get('thumbnail') %}
                <a href="{{ SITEURL }}{{ project.url }}" style="display: block;">
                    <img src="{{ SITEURL }}/{{ project.metadata.get('thumbnail') }}" alt="{{ project.title }}" class="card-thumb" style="width: 100%; object-fit: cover;">
                </a>
                {% else %}
                <a href="{{ SITEURL }}{{ project.url }}" style="display: block; background-color: #f0f0f0; height: 180px; display: flex; align-items: center; justify-content: center; color: #888;">
                   No Preview
                </a>
                {% endif %}
                
                <div class="card-content" style="flex-grow: 1;">
                    <h3><a href="{{ SITEURL }}{{ project.url }}">{{ project.title }}</a></h3>
                    
                    {# --- THE FIX IS HERE --- #}
                    {# Changed '%Y' to '%a %d %b %Y' to show 'Thu 11 Dec 2025' #}
                    <p class="muted">
                        {{ project.date.strftime('%a %d %b %Y') }} 
                    </p>
                    
                    <p class="summary">{{ project.summary|truncate(100, True, '...') }}</p>
                </div>
            </article>
        {% endfor %}
    </div>
</section>
{% endblock %}