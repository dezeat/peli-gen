{# Blog feed page: single-column feed, sidebar, pagination #}
{% extends "base.html" %}

{% block content %}
<div class="blog-page">
  <div class="feed">
    <h1 class="page-title">Blog</h1>
    {% for article in articles %}
    <article class="post-card">
      <div style="display:flex; align-items:flex-start; gap:1rem">
        {% if article.metadata.get('image') %}
        <img class="thumb" src="{{ SITEURL }}/{{ article.metadata.get('image') }}" alt="{{ article.title }}">
        {% endif %}
        <div>
          <header class="post-head">
            <h2 class="post-title"><a href="{{ SITEURL }}{{ article.url }}">{{ article.title }}</a></h2>
            <div class="meta">{{ article.date.strftime('%Y-%m-%d') }} • {{ article.author }}</div>
          </header>
          <div class="post-summary">{{ article.summary }}</div>
          <p class="read-more"><a href="{{ SITEURL }}{{ article.url }}">Read →</a></p>
        </div>
      </div>
    </article>
    {% endfor %}

    <nav class="pagination">{# implement pagination if needed #}</nav>
  </div>

  <aside class="sidebar">
    <div class="search-box">
      <input placeholder="Search" />
    </div>
    <div class="widget">
      <h3>Categories</h3>
      <ul class="categories-list">
        {# Build unique categories from articles (safe even if category pages aren't generated) #}
        {% set seen = [] %}
        {% for a in articles %}
          {% if a.category and a.category not in seen %}
            {% set _ = seen.append(a.category) %}
          {% endif %}
        {% endfor %}
        {% for c in seen %}
          <li><span class="cat-badge">{{ c }}</span></li>
        {% endfor %}
      </ul>
    </div>
    <div class="widget">
      <h3>Recent Posts</h3>
      <ul>
        {% for post in articles[:5] %}
        <li><a href="{{ SITEURL }}{{ post.url }}">{{ post.title }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </aside>
</div>
{% endblock %}
